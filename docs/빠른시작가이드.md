# 빠른 시작 가이드

> 처음 프로젝트를 받았을 때 개발 환경 구축 방법

---

## 1. 필수 프로그램 설치

### Node.js 18 이상
```bash
# 버전 확인
node --version  # v18 이상이어야 함
npm --version
```

다운로드: https://nodejs.org/

### Docker Desktop
다운로드: https://www.docker.com/products/docker-desktop

---

## 2. 프로젝트 설치

```bash
# 프로젝트 클론
git clone <repository-url>
cd APS_APP

# 프론트엔드 의존성 설치
npm install

# 백엔드 의존성 설치
cd backend-local
npm install
cd ..
```

---

## 3. GCP 서비스 계정 설정

### 3-1. 서비스 계정 JSON 파일 받기
1. GCP Console → IAM 및 관리자 → 서비스 계정
2. 기존 서비스 계정 선택 또는 새로 생성
3. 키 탭 → 키 추가 → JSON 형식으로 다운로드

### 3-2. JSON 파일 배치
```bash
# backend-local 폴더에 복사
cp /path/to/downloaded-key.json backend-local/gcp-service-account.json
```

---

## 4. 환경변수 설정

`backend-local/.env` 파일 생성:

```env
# 서버 설정
PORT=3001
JWT_SECRET=your-super-secret-key-change-this-in-production
JWT_REFRESH_SECRET=your-refresh-secret-key-change-this-too

# GCP 인증
GOOGLE_APPLICATION_CREDENTIALS=./gcp-service-account.json
STORAGE_BUCKET=aps-list

# PostgreSQL (Docker 기본값 - 변경 불필요)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=aps_admin
POSTGRES_USER=aps_admin
POSTGRES_PASSWORD=aps_password_2024

# ZOHO Mail (선택사항 - 없어도 앱 실행 가능)
ZOHO_ENABLED=false

# Aligo SMS (선택사항)
# ALIGO_API_KEY=
# ALIGO_USER_ID=
# ALIGO_SENDER_PHONE=

# WebSocket Relay (선택사항)
RELAY_WS_URL=ws://34.136.113.67.193:8080
```

---

## 5. Docker 백엔드 실행

```bash
cd backend-local

# Docker 컨테이너 시작 (최초 실행 시 이미지 빌드)
docker-compose up -d

# 로그 확인 (정상 실행 확인)
docker-compose logs -f

# Ctrl+C로 로그 종료 (컨테이너는 계속 실행됨)
```

정상 실행 시 출력:
```
✓ Firebase Admin initialized successfully
✓ PostgreSQL connection successful
✓ APS Admin Local Backend Server running on port 3001
```

---

## 6. 관리자 계정 생성

```bash
cd backend-local
node create-admin.js admin@test.com Password123 "관리자" admin
```

성공 시:
```
✅ Admin user created successfully in Firestore!
---------------------------------------------------
Email:        admin@test.com
Display Name: 관리자
Role:         admin
---------------------------------------------------
```

---

## 7. Electron 앱 실행

```bash
# 프로젝트 루트 디렉토리로 이동
cd ..  # (backend-local에서 상위로)

# 개발 모드로 앱 실행
npm run electron:dev
```

앱이 실행되면:
1. 로그인 화면에서 `admin@test.com` / `Password123` 입력
2. 로그인 버튼 클릭
3. 상담 목록 화면이 표시되면 성공!

---

## 8. 개발 시작

### 프론트엔드 수정 시
- `src/` 폴더의 파일을 수정하면 Vite가 자동으로 핫 리로드
- Electron 앱이 자동으로 새로고침됨

### 백엔드 수정 시
```bash
# Docker 컨테이너 재시작
cd backend-local
docker-compose restart backend
docker-compose logs -f backend  # 로그 확인
```

---

## 트러블슈팅

### Docker 컨테이너가 시작되지 않을 때
```bash
# 기존 컨테이너 완전 삭제 후 재시작
docker-compose down
docker-compose up -d
```

### PostgreSQL 연결 오류
```bash
# PostgreSQL 컨테이너 상태 확인
docker-compose ps

# PostgreSQL 재시작
docker-compose restart postgres
```

### "Firebase Admin initialization failed" 오류
- `GOOGLE_APPLICATION_CREDENTIALS` 경로 확인
- JSON 파일이 `backend-local/` 폴더에 있는지 확인

### 로그인 시 "Invalid email or password"
- 관리자 계정이 생성되었는지 확인
- Firestore Console에서 `admins` 컬렉션 확인

---

## 다음 단계

- [프로젝트소개.md](../프로젝트소개.md) - 전체 프로젝트 구조 이해
- [계정추가법.md](계정추가법.md) - 추가 사용자 계정 만들기
- 코드 수정 시작!

---

**첫 실행까지 걸리는 시간: 약 15~20분**
