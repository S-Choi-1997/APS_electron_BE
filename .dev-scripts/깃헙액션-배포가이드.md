# GitHub Actions ìë™ ë°°í¬ ê°€ì´ë“œ

GitHubì— ì½”ë“œë¥¼ í‘¸ì‹œí•˜ë©´ ìë™ìœ¼ë¡œ Docker ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  Docker Hubì— ë°°í¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

## ğŸ¯ ì¥ì 

- âœ… ë¡œì»¬ PCì— Docker ì„¤ì¹˜ ë¶ˆí•„ìš”
- âœ… ì½”ë“œ í‘¸ì‹œë§Œìœ¼ë¡œ ìë™ ë¹Œë“œ/ë°°í¬
- âœ… ë²„ì „ íƒœê·¸ ìë™ ê´€ë¦¬
- âœ… ë¹Œë“œ ë¡œê·¸ GitHubì—ì„œ í™•ì¸ ê°€ëŠ¥
- âœ… ë¬´ë£Œ (GitHub Actions ë¬´ë£Œ í•œë„ ë‚´)

## ğŸ“‹ ì´ˆê¸° ì„¤ì • (1íšŒë§Œ)

### 1. GitHub Repository Secrets ì„¤ì •

GitHub ì €ì¥ì†Œ â†’ Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret

**ì¶”ê°€í•  Secrets:**

| Name | Value | ì„¤ëª… |
|------|-------|------|
| `DOCKER_USERNAME` | `choho97` | Docker Hub ì‚¬ìš©ìëª… |
| `DOCKER_PASSWORD` | `********` | Docker Hub ë¹„ë°€ë²ˆí˜¸ ë˜ëŠ” Access Token |

**Docker Hub Access Token ìƒì„± (ê¶Œì¥):**
1. https://hub.docker.com/settings/security ì ‘ì†
2. "New Access Token" í´ë¦­
3. í† í° ì´ë¦„: `github-actions`
4. ê¶Œí•œ: `Read, Write, Delete`
5. ìƒì„±ëœ í† í°ì„ `DOCKER_PASSWORD`ë¡œ ì‚¬ìš©

### 2. GitHub Workflow íŒŒì¼ í™•ì¸

íŒŒì¼ì´ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤:
```
.github/workflows/docker-build-push.yml
```

ì´ íŒŒì¼ì´ ì €ì¥ì†Œì— ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ë°©ë²• 1: ì½”ë“œ í‘¸ì‹œë¡œ ìë™ ë¹Œë“œ (latest)

```bash
git add .
git commit -m "Update backend code"
git push origin main
```

â†’ ìë™ìœ¼ë¡œ `choho97/aps-admin-backend:latest` ì´ë¯¸ì§€ ë¹Œë“œ ë° í‘¸ì‹œ

### ë°©ë²• 2: ë²„ì „ íƒœê·¸ë¡œ ë¦´ë¦¬ìŠ¤ ë¹Œë“œ

```bash
# ë²„ì „ íƒœê·¸ ìƒì„± ë° í‘¸ì‹œ
git tag v1.0.0
git push origin v1.0.0
```

â†’ ìë™ìœ¼ë¡œ ë‹¤ìŒ ì´ë¯¸ì§€ë“¤ì´ ë¹Œë“œ ë° í‘¸ì‹œë¨:
- `choho97/aps-admin-backend:1.0.0`
- `choho97/aps-admin-backend:latest`

### ë°©ë²• 3: ìˆ˜ë™ ì‹¤í–‰

GitHub ì €ì¥ì†Œ â†’ Actions â†’ "Docker Build and Push" â†’ Run workflow

## ğŸ“Š ë¹Œë“œ ìƒíƒœ í™•ì¸

### GitHub Actions í˜ì´ì§€
1. GitHub ì €ì¥ì†Œ â†’ Actions íƒ­
2. ìµœê·¼ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ëª©ë¡ í™•ì¸
3. ì‹¤í–‰ ì¤‘ì¸ ì‘ì—… í´ë¦­ â†’ ë¡œê·¸ í™•ì¸

### ë¹Œë“œ ì„±ê³µ í™•ì¸
- âœ… ë…¹ìƒ‰ ì²´í¬ë§ˆí¬: ë¹Œë“œ ì„±ê³µ
- âŒ ë¹¨ê°„ X: ë¹Œë“œ ì‹¤íŒ¨ (ë¡œê·¸ í™•ì¸)

### Docker Hub í™•ì¸
https://hub.docker.com/r/choho97/aps-admin-backend/tags

## ğŸ”§ ì›Œí¬í”Œë¡œìš° ë™ì‘ ë°©ì‹

```yaml
íŠ¸ë¦¬ê±° ì¡°ê±´:
1. main/master ë¸Œëœì¹˜ì— push
2. v*.*.* í˜•ì‹ì˜ íƒœê·¸ push (ì˜ˆ: v1.0.0)
3. ìˆ˜ë™ ì‹¤í–‰ (workflow_dispatch)

ë¹Œë“œ ë‹¨ê³„:
1. ì½”ë“œ ì²´í¬ì•„ì›ƒ
2. Docker Buildx ì„¤ì •
3. Docker Hub ë¡œê·¸ì¸
4. ë²„ì „ ì¶”ì¶œ (íƒœê·¸ ë˜ëŠ” latest)
5. ì´ë¯¸ì§€ ë¹Œë“œ ë° í‘¸ì‹œ
6. ë¹Œë“œ ìºì‹œ ì €ì¥ (ë‹¤ìŒ ë¹Œë“œ ì†ë„ í–¥ìƒ)
```

## ğŸ“ ë²„ì „ ê´€ë¦¬ ì˜ˆì‹œ

### ê°œë°œ ë‹¨ê³„
```bash
git commit -m "feat: Add new feature"
git push origin main
# â†’ latest íƒœê·¸ë¡œ ë¹Œë“œ
```

### ë² íƒ€ ë¦´ë¦¬ìŠ¤
```bash
git tag v1.0.0-beta
git push origin v1.0.0-beta
# â†’ 1.0.0-beta + latest íƒœê·¸ë¡œ ë¹Œë“œ
```

### ì •ì‹ ë¦´ë¦¬ìŠ¤
```bash
git tag v1.0.0
git push origin v1.0.0
# â†’ 1.0.0 + latest íƒœê·¸ë¡œ ë¹Œë“œ
```

### íŒ¨ì¹˜ ë¦´ë¦¬ìŠ¤
```bash
git tag v1.0.1
git push origin v1.0.1
# â†’ 1.0.1 + latest íƒœê·¸ë¡œ ë¹Œë“œ
```

## ğŸ› ë¬¸ì œ í•´ê²°

### "Error: Invalid username/password"

**ì›ì¸**: Docker Hub Secretsê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ì˜ëª»ë¨

**í•´ê²°**:
1. GitHub ì €ì¥ì†Œ â†’ Settings â†’ Secrets and variables â†’ Actions
2. `DOCKER_USERNAME`ê³¼ `DOCKER_PASSWORD` í™•ì¸
3. Docker Hub ë¡œê·¸ì¸ ì •ë³´ê°€ ì •í™•í•œì§€ í™•ì¸

### "Error: denied: requested access to the resource is denied"

**ì›ì¸**: Docker Hub ì €ì¥ì†Œ ê¶Œí•œ ì—†ìŒ

**í•´ê²°**:
1. Docker Hubì—ì„œ `choho97/aps-admin-backend` ì €ì¥ì†Œ ìƒì„±
2. Access Token ê¶Œí•œ í™•ì¸ (Read, Write, Delete)

### ë¹Œë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ

**ì›ì¸**: ì›Œí¬í”Œë¡œìš° íŒŒì¼ ê²½ë¡œ ë˜ëŠ” ë¬¸ë²• ì˜¤ë¥˜

**í™•ì¸**:
- íŒŒì¼ ê²½ë¡œ: `.github/workflows/docker-build-push.yml`
- GitHub Actions íƒ­ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

### ë¹Œë“œ ì‹œê°„ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦¼

**ì›ì¸**: ì²« ë¹Œë“œëŠ” ìºì‹œê°€ ì—†ì–´ì„œ ì˜¤ë˜ ê±¸ë¦¼

**í•´ê²°**:
- ë‘ ë²ˆì§¸ ë¹Œë“œë¶€í„°ëŠ” ìºì‹œê°€ ì ìš©ë˜ì–´ ë¹ ë¦„ (1-2ë¶„)
- ë¹Œë“œ ìºì‹œ: `choho97/aps-admin-backend:buildcache`

## ğŸ“‚ ë¡œì»¬ ë¹Œë“œ vs GitHub Actions

| í•­ëª© | ë¡œì»¬ ë¹Œë“œ | GitHub Actions |
|------|----------|----------------|
| Docker ì„¤ì¹˜ | í•„ìš” | ë¶ˆí•„ìš” |
| ë¹Œë“œ ìœ„ì¹˜ | ë¡œì»¬ PC | GitHub ì„œë²„ |
| ë¹Œë“œ ì‹œê°„ | PC ì„±ëŠ¥ì— ë”°ë¼ | ì¼ì • (2-5ë¶„) |
| ë¡œê·¸ í™•ì¸ | í„°ë¯¸ë„ | GitHub Actions |
| ìë™í™” | ìˆ˜ë™ ì‹¤í–‰ | í‘¸ì‹œ ì‹œ ìë™ |
| ë¹„ìš© | ë¬´ë£Œ | ë¬´ë£Œ (í•œë„ ë‚´) |

## ğŸ” ë³´ì•ˆ

### Secrets ê´€ë¦¬
- âœ… GitHub SecretsëŠ” ì•”í˜¸í™”ë˜ì–´ ì €ì¥
- âœ… ë¡œê·¸ì— ë¹„ë°€ë²ˆí˜¸ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ
- âœ… Access Token ì‚¬ìš© ê¶Œì¥ (ë¹„ë°€ë²ˆí˜¸ë³´ë‹¤ ì•ˆì „)

### ì´ë¯¸ì§€ ë‚´ìš©
- âœ… `.dockerignore`ë¡œ ë¯¼ê° ì •ë³´ ì œì™¸
- âœ… `service-account.json` ì œì™¸ë¨
- âœ… `.env` íŒŒì¼ ì œì™¸ë¨
- âœ… ì†ŒìŠ¤ì½”ë“œë§Œ í¬í•¨

## ğŸ“Š GitHub Actions ë¬´ë£Œ í•œë„

**Public Repository:**
- ë¬´ì œí•œ ë¹Œë“œ ì‹œê°„

**Private Repository:**
- ì›” 2,000ë¶„ ë¬´ë£Œ
- 1íšŒ ë¹Œë“œ ì•½ 2-5ë¶„ ì†Œìš”
- ì›” ì•½ 400-1000íšŒ ë¹Œë“œ ê°€ëŠ¥

## ğŸ”— ë‹¤ìŒ ë‹¨ê³„

ë¹Œë“œëœ ì´ë¯¸ì§€ë¥¼ ë‹¤ë¥¸ ì„œë²„ì—ì„œ ì‚¬ìš©:
```bash
# ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
docker pull choho97/aps-admin-backend:latest

# ì‹¤í–‰
docker run -d \
  --name aps-admin-backend \
  -p 3001:3001 \
  --env-file .env \
  -v ./service-account.json:/app/service-account.json:ro \
  choho97/aps-admin-backend:latest
```

ìì„¸í•œ ë‚´ìš©ì€ [ë„ì»¤í—ˆë¸Œ-ë°°í¬ê°€ì´ë“œ.md](ë„ì»¤í—ˆë¸Œ-ë°°í¬ê°€ì´ë“œ.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

## ğŸ› ï¸ ê³ ê¸‰ ì„¤ì •

### íŠ¹ì • ë¸Œëœì¹˜ë§Œ ë¹Œë“œ

`.github/workflows/docker-build-push.yml` ìˆ˜ì •:
```yaml
on:
  push:
    branches:
      - main
      - develop  # develop ë¸Œëœì¹˜ ì¶”ê°€
```

### ë¹Œë“œ ì¡°ê±´ ì¶”ê°€

íŠ¹ì • íŒŒì¼ ë³€ê²½ ì‹œë§Œ ë¹Œë“œ:
```yaml
on:
  push:
    branches:
      - main
    paths:
      - 'backend-local/**'  # backend-local í´ë” ë³€ê²½ ì‹œë§Œ
```

### ì•Œë¦¼ ì¶”ê°€

ë¹Œë“œ ì™„ë£Œ ì‹œ Discord/Slack ì•Œë¦¼:
- GitHub Actions Marketplaceì—ì„œ ì•Œë¦¼ ì•¡ì…˜ ê²€ìƒ‰
- ì›Œí¬í”Œë¡œìš°ì— ì¶”ê°€ ë‹¨ê³„ë¡œ ì„¤ì •
